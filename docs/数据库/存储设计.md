# 数据库存储过程设计

## 1. **书籍管理存储过程**
   - **add_book**: 用于向 `book_store_book` 表中添加新的书籍信息。
   - **update_book**: 用于更新 `book_store_book` 表中的书籍信息，如价格、出版社、关键字等。
   - **delete_book**: 用于删除 `book_store_book` 表中的某本书。

## 2. **库存管理存储过程**
   - **update_inventory**: 当新书到货时，更新 `book_store_inventory` 表中的库存量。
   - **get_inventory_status**: 查询 `book_store_inventory` 中某本书的库存状态（如库存量、是否有库存等）。
   - **update_inventory_status**: 修改 `book_store_inventory` 表中的库存状态（如预定、售出等）。

## 3. **缺书管理存储过程**
   - **register_shortage**: 当书籍库存不足时，记录 `book_store_book_shortage` 表中的缺书信息。
   - **auto_generate_shortage_record**: 当库存低于设定限额时，自动生成缺书记录，插入 `book_store_book_shortage` 表。
   - **delete_shortage_record**: 删除不再需要的缺书记录。

## 4. **采购管理存储过程**
   - **generate_procurement_order**: 根据缺书登记生成采购单，插入 `book_store_procurement_order` 表。
   - **update_procurement_order_status**: 当书籍到货时，更新采购单状态并增加库存，修改 `book_store_procurement_order` 表。
   - **delete_procurement_order**: 删除已取消或不再需要的采购单。

## 5. **客户管理存储过程**
   - **register_customer**: 新客户注册时，插入客户信息到 `book_store_reader` 表。
   - **update_customer_info**: 修改客户的个人信息，如地址、账户余额等，更新 `book_store_reader` 表。
   - **delete_customer_account**: 删除不再使用的客户账户。

## 6. **订单管理存储过程**
   - **generate_order**: 根据客户的订购请求生成订单，插入 `book_store_order` 表。
   - **update_order_status**: 修改订单状态，如已发货、已取消等，更新 `book_store_order` 表。
   - **delete_order**: 删除无效或已取消的订单。
   - **deduct_customer_balance**: 根据订单金额扣减客户账户余额，更新 `book_store_reader` 表。
   - **check_inventory_for_order**: 检查订单中的书籍在 `book_store_inventory` 表中是否有足够库存，并处理库存不足情况。

## 7. **发货管理存储过程**
   - **process_shipping**: 根据订单确认发货，并更新订单的发货状态，更新 `book_store_order` 表。
   - **update_shipping_info**: 修改订单的发货地址或发货状态，更新 `book_store_order` 表。

## 8. **供应商管理存储过程**
   - **add_supplier_info**: 插入新的供应商信息到 `book_store_supplier` 表。
   - **update_supplier_info**: 更新供应商的基本信息，修改 `book_store_supplier` 表。
   - **delete_supplier_info**: 删除不再合作的供应商信息，更新 `book_store_supplier` 表。

## 9. **信用管理存储过程**
   - **update_customer_credit_level**: 根据客户的账户余额或购买金额调整其信用等级，更新 `book_store_reader` 表。
   - **get_customer_credit_level**: 查询客户当前的信用等级和相关信息，从 `book_store_reader` 表中获取。

## 10. **其他辅助存储过程**
   - **check_inventory_availability**: 检查 `book_store_inventory` 中某个书籍的库存是否足够满足订单需求。
   - **auto_generate_shortage_record**: 根据设定的库存阈值，自动生成缺书记录，插入 `book_store_book_shortage` 表。
